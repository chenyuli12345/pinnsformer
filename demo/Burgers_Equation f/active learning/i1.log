nohup: ignoring input
[NbConvertApp] Converting notebook Adam+LBFGS+LHS(dongtaifuheAC)(5000)ceshimax.ipynb to notebook
Traceback (most recent call last):
  File "/home/lcy/anaconda3/envs/torchgpu/bin/jupyter-nbconvert", line 8, in <module>
    sys.exit(main())
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/jupyter_core/application.py", line 283, in launch_instance
    super().launch_instance(argv=argv, **kwargs)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/traitlets/config/application.py", line 1075, in launch_instance
    app.start()
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/nbconvertapp.py", line 420, in start
    self.convert_notebooks()
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/nbconvertapp.py", line 597, in convert_notebooks
    self.convert_single_notebook(notebook_filename)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/nbconvertapp.py", line 563, in convert_single_notebook
    output, resources = self.export_single_notebook(
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/nbconvertapp.py", line 487, in export_single_notebook
    output, resources = self.exporter.from_filename(
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/exporters/exporter.py", line 201, in from_filename
    return self.from_file(f, resources=resources, **kw)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/exporters/exporter.py", line 220, in from_file
    return self.from_notebook_node(
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/exporters/notebook.py", line 36, in from_notebook_node
    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/exporters/exporter.py", line 154, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/exporters/exporter.py", line 353, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/preprocessors/base.py", line 48, in __call__
    return self.preprocess(nb, resources)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/lcy/anaconda3/envs/torchgpu/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
#RAR-Gæ–¹æ³•ï¼Œå¯¹1000ä¸ªç‚¹ï¼Œå…ˆé€‰æ‹©10ä¸ªç‚¹è®­ç»ƒ500æ¬¡ï¼Œç„¶åæ¯500æ¬¡è¿­ä»£é‡é‡‡æ ·100ä¸ªç‚¹ï¼Œé€‰å‡ºå…¶ä¸­æ®‹å·®æœ€å¤§çš„10ä¸ªç‚¹æ·»åŠ åˆ°è®­ç»ƒç‚¹ä¸­ï¼›æœ€åæ€»å…±æœ‰1000ä¸ªç‚¹ï¼Œå…±è®­ç»ƒ10000æ¬¡
seeds = [0, 1, 12, 33, 123, 321, 1234, 4321, 12345, 54321] #ç”Ÿæˆ10ä¸ªéšæœºç§å­
# seeds = [0]

nu = 0.01/np.pi
#è®¾ç½®å™ªå£°æ°´å¹³ä¸º0
noise = 0.0        

N_u = 100
N_f = 5000
nIter = 50000 #è®¾ç½®è¿­ä»£æ¬¡æ•°ä¸º10000
nIterLBFGS = 500 #è®¾ç½®LBFGSè¿­ä»£æ¬¡æ•°ä¸º500


#å®šä¹‰ä¸€ä¸ªåˆ—è¡¨layersï¼Œå…¶ä¸­åŒ…å«äº†ç¥ç»ç½‘ç»œçš„å±‚æ•°å’Œæ¯ä¸€å±‚çš„ç¥ç»å…ƒæ•°é‡
layers = [2, 20, 20, 20, 20, 20, 20, 20, 20, 2, 1]
#è¯»å–åä¸ºburgers_shockçš„Matlabæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­çš„æ•°æ®å­˜å‚¨åœ¨dataå˜é‡ä¸­ã€‚è¿™é‡Œçš„è·¯å¾„ä¹Ÿè¦éšç€è®¾å¤‡çš„æƒ…å†µä¿®æ”¹ 
data = scipy.io.loadmat('../data/burgers_shock.mat')
#ä»dataå­—å…¸ä¸­å–å‡ºå˜é‡ttå’Œxçš„å€¼ï¼Œå¹¶è½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ï¼ˆflattenæ–¹æ³•ï¼‰ï¼Œæœ€åtongg[:,None]å°†ä¸€ç»´æ•°ç»„è½¬æ¢ä¸ºäºŒç»´æ•°ç»„
t = data['t'].flatten()[:,None]
x = data['x'].flatten()[:,None]
Exact = np.real(data['usol']).T #ä»dataæ•°æ®ä¸­å–å‡ºusolçš„å€¼ï¼Œå¹¶å–å®éƒ¨ï¼Œæœ€åè½¬ç½®ï¼Œèµ‹å€¼ç»™Exact
#ç”Ÿæˆä¸€ä¸ªäºŒä½ç½‘ç»œï¼ŒXå’ŒTæ˜¯è¾“å‡ºçš„äºŒç»´æ•°ç»„
#è¿™ä¸ªç‚¹ç»“æœæ˜¯Xå’ŒTå‡ä¸ºå½¢çŠ¶ä¸º[len(t),len(x)]çš„äºŒç»´æ•°ç»„ï¼ŒXçš„æ¯ä¸€è¡Œéƒ½æ˜¯xï¼Œä¸€å…±len(t)è¡Œï¼ŒTçš„æ¯ä¸€åˆ—éƒ½æ˜¯tï¼Œä¸€å…±len(x)åˆ—
X, T = np.meshgrid(x,t)

X_star = np.hstack((X.flatten()[:,None], T.flatten()[:,None]))  #æŒ‰åˆ—å †å æ•°ç»„ï¼ŒX_staræ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€åˆ—æ˜¯Xçš„å±•å¹³ï¼Œç¬¬äºŒåˆ—æ˜¯Tçš„å±•å¹³
u_star = Exact.flatten()[:,None]    #å¯¹Exact_uä½¿ç”¨flattenæ–¹æ³•å°†å…¶è½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ï¼Œæœ€åä½¿ç”¨[:,None]å°†å…¶è½¬æ¢ä¸ºäºŒç»´æ•°ç»„        

# from sklearn.model_selection import train_test_split
# # å°†æ•°æ®é›†åˆ†ä¸ºæµ‹è¯•é›†å’ŒéªŒè¯é›†ï¼ŒéªŒè¯é›†å æ¯”50%
# X_test, X_val, u_test, u_val = train_test_split(X_star, u_star, test_size=0.5, random_state=42) #æœ€åä¸€ä¸ªå‚æ•°æ˜¯éšæœºç§å­ï¼Œä¿è¯æ¯æ¬¡åˆ’åˆ†çš„ç»“æœéƒ½ä¸€æ ·



# Doman boundsï¼Œåˆ†åˆ«è·å¾—X_starçš„ç›¸åº”åˆ—ä¸Šçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œèµ‹å€¼ç»™lbå’Œub,ä¹Ÿå°±æ˜¯è¯´lbæ˜¯xå’Œtçš„æœ€å°å€¼ï¼Œubæ˜¯xå’Œtçš„æœ€å¤§å€¼ï¼Œå³lbå’Œubåˆ†åˆ«ä¸º[-1,0]å’Œ[1,1]
lb = X_star.min(0)
ub = X_star.max(0)    


#ç”Ÿæˆåˆå€¼å’Œè¾¹ç•Œå€¼çš„è®­ç»ƒåŸºç¡€æ•°æ®
xx1 = np.hstack((X[0:1,:].T, T[0:1,:].T)) #åˆ†åˆ«å–Xï¼ŒTçš„ç¬¬ä¸€è¡Œçš„è½¬ç½®(åˆ†åˆ«æ˜¯xå’Œå…¨0åˆ—)ï¼Œåˆ†åˆ«æ„æˆxx1çš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—
uu1 = Exact[0:1,:].T #å–Exactçš„ç¬¬ä¸€è¡Œçš„è½¬ç½®ï¼Œèµ‹å€¼ç»™uu1
xx2 = np.hstack((X[:,0:1], T[:,0:1])) #åˆ†åˆ«å–Xï¼ŒTçš„ç¬¬ä¸€åˆ—(åˆ†åˆ«æ˜¯å…¨-1åˆ—å’Œt)ï¼Œåˆ†åˆ«æ„æˆxx2çš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—
uu2 = Exact[:,0:1] #å–Exactçš„ç¬¬ä¸€åˆ—ï¼Œèµ‹å€¼ç»™uu2
xx3 = np.hstack((X[:,-1:], T[:,-1:])) #åˆ†åˆ«å–Xï¼ŒTçš„æœ€åä¸€åˆ—(åˆ†åˆ«æ˜¯å…¨1åˆ—å’Œt)ï¼Œåˆ†åˆ«æ„æˆxx3çš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—
uu3 = Exact[:,-1:] #å–Exactçš„æœ€åä¸€åˆ—ï¼Œèµ‹å€¼ç»™uu3

X_u_train_all = np.vstack([xx1, xx2, xx3]) #X_u_train=(xx1;xx2;xx3)

u_train_all = np.vstack([uu1, uu2, uu3]) #u_train=(uu1;uu2;uu3)
    

#1.ç”Ÿæˆåˆå€¼è¾¹ç•Œå€¼è®­ç»ƒæ•°æ®ï¼Œä»¥åŠæµ‹è¯•æ•°æ®

#ä»æ‰€æœ‰çš„åˆå€¼è¾¹ç•Œå€¼è®­ç»ƒåŸºç¡€æ•°æ®ä¸­é€‰å–N_u=100ä¸ªç‚¹
idx = np.linspace(0, X_u_train_all.shape[0] - 1, N_u, dtype=int) #ç”Ÿæˆä¸€ä¸ªç­‰å·®æ•°åˆ—ï¼Œä»0åˆ°X_u_trainçš„è¡Œæ•°ï¼Œé—´éš”ä¸º1ï¼Œèµ‹å€¼ç»™idx
# idx = np.random.choice(X_u_train_all.shape[0], N_u, replace=False) #ä»0~æ•°ç»„X_u_trainçš„è¡Œæ•° ä¸­éšæœºé€‰æ‹©N_uä¸ªæ•°ï¼Œreplace=Falseè¡¨ç¤ºä¸å…è®¸é‡å¤é€‰æ‹©ï¼Œæœ€åå°†è¿™N_uä¸ªæ•°èµ‹å€¼ç»™idx
X_u_train = X_u_train_all[idx, :] #ä»X_u_trainä¸­é€‰å–idxå¯¹åº”çš„çš„N_uè¡Œï¼Œèµ‹å€¼ç»™X_u_train
u_train = u_train_all[idx,:] #ä»u_trainä¸­é€‰å–idxå¯¹åº”çš„çš„N_uè¡Œï¼Œèµ‹å€¼ç»™u_train


error_u = [] #åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨è¯¯å·®å€¼
error_mae = [] #åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨MAEå€¼
error_mse = [] #åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨MSEå€¼


i = 0 #åˆå§‹åŒ–iä¸º0

# åˆ›å»ºæ–‡ä»¶å¤¹
model_dir = 'Adam+LBFGS+LHS(fuheAC)(2500)'
if not os.path.exists(model_dir):
    os.makedirs(model_dir)


for seed in seeds:
    set_seed(seed) #è®¾ç½®éšæœºæ•°ç§å­


    #2.ç”Ÿæˆé…ä½ç‚¹å¹¶è¿›è¡Œè®­ç»ƒ

    num_iter = 100 #chaosè¿­ä»£æ¬¡æ•°

    #å…ˆè®­ç»ƒ500æ¬¡
    #é‡‡æ ·é…ä½ç‚¹10ä¸ª
    N_f_1 = N_f//100 #N_f_1=50
    X_f_train = caiyang(N_f_1, "LHS") #ç”Ÿæˆ50ä¸ªæ ·æœ¬ç‚¹ï¼Œæ¯ä¸ªæ ·æœ¬ç‚¹éƒ½æ˜¯ä¸€ä¸ªäºŒç»´ç‚¹ï¼Œå³50*2çš„æ•°æ®ç‚¹

    #åˆ›å»ºPINNæ¨¡å‹å¹¶è¾“å…¥å„ç§å‚æ•°     
    model = PhysicsInformedNN(X_u_train, u_train, X_f_train, layers, lb, ub, nu, X_star, u_star)

    #è·å–å½“å‰æ—¶é—´å¹¶èµ‹å€¼ç»™start_time  
    start_time = time.time()   
    #å¼€å§‹è®­ç»ƒæ¨¡å‹            
    model.train(nIter//100,0)

    # ç”Ÿæˆæƒé‡ç»„åˆ
    weight_combinations = generate_weight_combinations(num_weights=10)
    #å¾—åˆ°å·²ç»è®­ç»ƒè¿‡çš„ç‚¹é›†çš„æ··æ²Œåº¦å’Œæ®‹å·®
    abs_residual_past, distances_past = calculate_residual_chaos(model, X_f_train, num_iter)
    #è®¡ç®—è¿‡å»çš„æ®‹å·®å’Œæ··æ²Œåº¦çš„æƒé‡
    best_weights_past = calculate_past(weight_combinations, abs_residual_past, distances_past)


    #è®­ç»ƒç»“æŸåï¼Œæ¯500æ¬¡è¿­ä»£é‡é‡‡æ ·ä¸€æ¬¡100ä¸ªç‚¹ï¼Œå¹¶é€‰å‡ºå…¶ä¸­æ®‹å·®æœ€å¤§çš„10ä¸ªç‚¹æ·»åŠ åˆ°è®­ç»ƒç‚¹ä¸­ï¼›æœ€åæ€»å…±æœ‰1000ä¸ªç‚¹ï¼Œå…±è®­ç»ƒ50000æ¬¡
    for iter in range(nIter//100+1, nIter+1, nIter//100): #æ¯500æ¬¡è¿­ä»£
        N_f_new = N_f_1 * 10 #é‡æ–°é‡‡æ ·100ä¸ªç‚¹
        # ç”Ÿæˆæ–°çš„X_f_trainæ•°æ®
        X_f_train_new = caiyang(N_f_new, "LHS") #ç”Ÿæˆ500ä¸ªæ ·æœ¬ç‚¹ï¼Œæ¯ä¸ªæ ·æœ¬ç‚¹éƒ½æ˜¯ä¸€ä¸ªäºŒç»´ç‚¹ï¼Œå³500*2çš„æ•°æ®ç‚¹

        abs_residual, distances = calculate_residual_chaos(model, X_f_train_new, num_iter)


        xinxi = best_weights_past[1] * distances + best_weights_past[0] * abs_residual #å°†ä¸‰ä¸ªå½’ä¸€åŒ–åçš„æ•°ç»„ç›¸åŠ ï¼Œå¾—åˆ°æ–°çš„æ•°ç»„xinxi

        # æ‰¾å‡ºç»å¯¹å€¼æœ€å¤§çš„10ä¸ªå€¼çš„ç´¢å¼•
        topk_indices = np.argpartition(xinxi, -N_f_1)[-N_f_1:] #è¯¥å‡½æ•°ä¼šå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œä½¿å¾—æŒ‡å®šçš„kä¸ªæœ€å¤§å€¼å‡ºç°åœ¨æ•°ç»„çš„æœ€åkç»™ä½ç½®ä¸Šï¼Œå¹¶è·å–æœ€å1000ä¸ªå…ƒç´ 

        # ä½¿ç”¨è¿™äº›ç´¢å¼•æ¥æå–å¯¹åº”çš„æ•°æ®
        X_f_train_topk = X_f_train_new[topk_indices]

        X_f_train = np.vstack((X_f_train, X_f_train_topk)) #ä¸ä¹‹å‰çš„è®­ç»ƒæ•°æ®åˆå¹¶

        # æ›´æ–°æ¨¡å‹ä¸­çš„X_f_trainæ•°æ®
        model.x_f = torch.tensor(X_f_train[:, 0:1], requires_grad=True).float().to(device)
        model.t_f = torch.tensor(X_f_train[:, 1:2], requires_grad=True).float().to(device)

        # åœ¨æ›´æ–°æ•°æ®åçš„æ¨¡å‹ä¸Šè¿›è¡Œè®­ç»ƒ500æ¬¡
        model.train(nIter//100,0)


        #æ›´æ–°è¿‡å»çš„æ®‹å·®å’Œæ··æ²Œåº¦çš„æƒé‡
        #å¾—åˆ°å·²ç»è®­ç»ƒè¿‡çš„ç‚¹é›†çš„æ··æ²Œåº¦å’Œæ®‹å·®
        abs_residual_past, distances_past = calculate_residual_chaos(model, X_f_train, num_iter)
        #è®¡ç®—è¿‡å»çš„æ®‹å·®å’Œæ··æ²Œåº¦çš„æƒé‡
        best_weights_past = calculate_past(weight_combinations, abs_residual_past, distances_past)




    model.train(0,nIterLBFGS) #ä½¿ç”¨LBFGSè®­ç»ƒ500æ¬¡
    #æ‰€æœ‰è®­ç»ƒç»“æŸåè·å–å½“å‰æ—¶é—´å¹¶å‡å»start_timeï¼Œå¾—åˆ°è®­ç»ƒæ—¶é—´å¹¶èµ‹å€¼ç»™elapsed
    elapsed = time.time() - start_time
    #æ‰“å°è®­ç»ƒæ‰€èŠ±æ—¶é—´                
    print('Training time: %.4f' % (elapsed))

    # è®­ç»ƒç»“æŸåï¼Œå†æ¬¡ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œå¹¶è®¡ç®—è¯¯å·®
    u_pred, f_pred = model.predict(X_star)
    error_u.append(np.linalg.norm(u_star-u_pred,2)/np.linalg.norm(u_star,2)) #è®¡ç®—è¯¯å·®ï¼Œç„¶åå°†è¯¯å·®æ·»åŠ åˆ°error_uåˆ—è¡¨ä¸­
    # è®¡ç®— MAE å’Œ MSE
    mae = np.mean(np.abs(u_star - u_pred))
    mse = np.mean((u_star - u_pred) ** 2)
    # è®°å½• MAE å’Œ MSE
    error_mae.append(mae)
    error_mse.append(mse)

    i+=1 #iåŠ 1
    print(f'å½“å‰ä¸ºç¬¬{i}æ¬¡å¾ªç¯ï¼Œç§å­ä¸º{seed}')
    print('Error u : %e' % (np.linalg.norm(u_star-u_pred,2)/np.linalg.norm(u_star,2))) #æ‰“å°è¯¯å·®  
    print('MAE: %e' % mae) #æ‰“å°MAE
    print('MSE: %e' % mse) #æ‰“å°MSE
    
    # ä¿å­˜æ¨¡å‹åˆ°æ–‡ä»¶å¤¹
    model_path = os.path.join(model_dir, f'model_{i}_seed_{seed}.pkl')
    with open(model_path, 'wb') as f:
        pickle.dump(model, f)

------------------

----- stderr -----

Adam:   0%|          | 0/500 [00:00<?, ?it/s]
----- stderr -----

Adam:   0%|          | 2/500 [00:00<00:25, 19.22it/s]
----- stderr -----

Adam:   6%|â–‹         | 32/500 [00:00<00:02, 180.43it/s]
----- stderr -----

Adam:  13%|â–ˆâ–        | 63/500 [00:00<00:01, 237.27it/s]
----- stderr -----

Adam:  19%|â–ˆâ–Š        | 93/500 [00:00<00:01, 258.80it/s]
----- stderr -----

Adam:  25%|â–ˆâ–ˆâ–       | 123/500 [00:00<00:01, 273.05it/s]
----- stderr -----

Adam:  31%|â–ˆâ–ˆâ–ˆ       | 153/500 [00:00<00:01, 281.02it/s]
----- stderr -----

Adam:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 183/500 [00:00<00:01, 286.45it/s]
----- stderr -----

Adam:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 213/500 [00:00<00:00, 289.91it/s]
----- stderr -----

Adam:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 243/500 [00:00<00:00, 286.74it/s]
----- stderr -----

Adam:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 273/500 [00:01<00:00, 290.67it/s]
----- stderr -----

Adam:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 304/500 [00:01<00:00, 295.58it/s]
----- stderr -----

Adam:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 334/500 [00:01<00:00, 292.61it/s]
----- stderr -----

Adam:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 364/500 [00:01<00:00, 290.05it/s]
----- stderr -----

Adam:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 395/500 [00:01<00:00, 295.71it/s]
----- stderr -----

Adam:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 425/500 [00:01<00:00, 287.25it/s]
----- stderr -----

Adam:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 456/500 [00:01<00:00, 292.35it/s]
----- stderr -----

Adam:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 486/500 [00:01<00:00, 279.24it/s]
----- stderr -----

Adam: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [00:01<00:00, 275.09it/s]
----- stderr -----

----- stderr -----

LBFGS: 0it [00:00, ?it/s]
----- stderr -----

LBFGS: 0it [00:00, ?it/s]
----- stderr -----

------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mAttributeError[0m                            Traceback (most recent call last)
Cell [0;32mIn[12], line 102[0m
[1;32m    100[0m abs_residual_past, distances_past [38;5;241m=[39m calculate_residual_chaos(model, X_f_train, num_iter)
[1;32m    101[0m [38;5;66;03m#è®¡ç®—è¿‡å»çš„æ®‹å·®å’Œæ··æ²Œåº¦çš„æƒé‡[39;00m
[0;32m--> 102[0m best_weights_past [38;5;241m=[39m [43mcalculate_past[49m[43m([49m[43mweight_combinations[49m[43m,[49m[43m [49m[43mabs_residual_past[49m[43m,[49m[43m [49m[43mdistances_past[49m[43m)[49m
[1;32m    105[0m [38;5;66;03m#è®­ç»ƒç»“æŸåï¼Œæ¯500æ¬¡è¿­ä»£é‡é‡‡æ ·ä¸€æ¬¡100ä¸ªç‚¹ï¼Œå¹¶é€‰å‡ºå…¶ä¸­æ®‹å·®æœ€å¤§çš„10ä¸ªç‚¹æ·»åŠ åˆ°è®­ç»ƒç‚¹ä¸­ï¼›æœ€åæ€»å…±æœ‰1000ä¸ªç‚¹ï¼Œå…±è®­ç»ƒ50000æ¬¡[39;00m
[1;32m    106[0m [38;5;28;01mfor[39;00m [38;5;28miter[39m [38;5;129;01min[39;00m [38;5;28mrange[39m(nIter[38;5;241m/[39m[38;5;241m/[39m[38;5;241m100[39m[38;5;241m+[39m[38;5;241m1[39m, nIter[38;5;241m+[39m[38;5;241m1[39m, nIter[38;5;241m/[39m[38;5;241m/[39m[38;5;241m100[39m): [38;5;66;03m#æ¯500æ¬¡è¿­ä»£[39;00m

Cell [0;32mIn[11], line 13[0m, in [0;36mcalculate_past[0;34m(weight_combinations, abs_residual, distances)[0m
[1;32m      8[0m     validation_errors[38;5;241m.[39mappend(val_error[38;5;241m.[39msum())
[1;32m      9[0m     [38;5;66;03m# print(f"Weight (Residual: {w_residual:.2f}, Chaos: {w_chaos:.2f}) - Validation Error: {val_error:.4f}")[39;00m
[1;32m     10[0m [38;5;66;03m# print(validation_errors)[39;00m
[1;32m     11[0m [38;5;66;03m# print(len(validation_errors))[39;00m
[1;32m     12[0m [38;5;66;03m# é€‰æ‹©éªŒè¯è¯¯å·®æœ€å°çš„æƒé‡ç»„åˆ[39;00m
[0;32m---> 13[0m best_index [38;5;241m=[39m [43mnp[49m[38;5;241;43m.[39;49m[43margax[49m(validation_errors)
[1;32m     14[0m [38;5;28mprint[39m(best_index)
[1;32m     15[0m best_weights [38;5;241m=[39m weight_combinations[best_index]

File [0;32m~/anaconda3/envs/torchgpu/lib/python3.10/site-packages/numpy/__init__.py:333[0m, in [0;36m__getattr__[0;34m(attr)[0m
[1;32m    330[0m     [38;5;124m"[39m[38;5;124mRemoved in NumPy 1.25.0[39m[38;5;124m"[39m
[1;32m    331[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124m"[39m[38;5;124mTester was removed in NumPy 1.25.[39m[38;5;124m"[39m)
[0;32m--> 333[0m [38;5;28;01mraise[39;00m [38;5;167;01mAttributeError[39;00m([38;5;124m"[39m[38;5;124mmodule [39m[38;5;132;01m{!r}[39;00m[38;5;124m has no attribute [39m[38;5;124m"[39m
[1;32m    334[0m                      [38;5;124m"[39m[38;5;132;01m{!r}[39;00m[38;5;124m"[39m[38;5;241m.[39mformat([38;5;18m__name__[39m, attr))

[0;31mAttributeError[0m: module 'numpy' has no attribute 'argax'





































































































































































































































